{{ 'component-article-card.css' | asset_url | stylesheet_tag }}
{{ 'section-featured-blog.css' | asset_url | stylesheet_tag }}

{%- style -%}
  .featured-blog-{{ section.id }} {
    --heading-color: {{ section.settings.heading_color }};
    --text-color: {{ section.settings.text_color }};
    --card-background: {{ section.settings.card_background }};
    --card-border: {{ section.settings.card_border }};
    --card-hover-shadow: {{ section.settings.card_hover_shadow }};
    
    padding-top: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;
    padding-bottom: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px;
  }

  @media screen and (min-width: 750px) {
    .featured-blog-{{ section.id }} {
      padding-top: {{ section.settings.padding_top }}px;
      padding-bottom: {{ section.settings.padding_bottom }}px;
    }
  }

  .featured-blog-{{ section.id }} .featured-blog__heading,
  .featured-blog-{{ section.id }} .featured-blog__subheading {
    color: var(--heading-color);
  }

  .featured-blog-{{ section.id }} .featured-blog__description {
    color: var(--text-color);
  }

  .featured-blog-{{ section.id }} .article-card {
    background-color: var(--card-background);
    border: 1px solid var(--card-border);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }

  .featured-blog-{{ section.id }} .article-card:hover {
    box-shadow: 0 10px 25px var(--card-hover-shadow);
  }
{%- endstyle -%}

{%- liquid
  assign blog = blogs[section.settings.blog]
  assign posts_displayed = 0
  assign posts_to_display = section.settings.posts_to_show
  assign columns_desktop = section.settings.columns_desktop
  assign columns_mobile = section.settings.columns_mobile
  
  if section.settings.blog != blank and blog.articles_count > 0
    assign show_placeholder = false
  else
    assign show_placeholder = true
  endif
-%}

<div class="featured-blog featured-blog-{{ section.id }} color-{{ section.settings.color_scheme }} gradient">
  <div class="page-width">
    <div class="featured-blog__header text-{{ section.settings.heading_alignment }}">
      {%- if section.settings.heading != blank -%}
        <h2 class="featured-blog__heading {{ section.settings.heading_size }}">
          {{ section.settings.heading | escape }}
        </h2>
      {%- endif -%}
      
      {%- if section.settings.subheading != blank -%}
        <p class="featured-blog__subheading">{{ section.settings.subheading | escape }}</p>
      {%- endif -%}
      
      {%- if section.settings.description != blank -%}
        <div class="featured-blog__description rte">{{ section.settings.description }}</div>
      {%- endif -%}
    </div>
    
    <div class="featured-blog__grid grid grid--{{ columns_mobile }}-col-tablet-down grid--{{ columns_desktop }}-col-desktop">
      {%- if show_placeholder -%}
        {%- for i in (1..posts_to_display) -%}
          <div class="grid__item">
            {% render 'article-card-placeholder', index: forloop.index %}
          </div>
        {%- endfor -%}
      {%- else -%}
        {%- for article in blog.articles limit: posts_to_display -%}
          <div class="grid__item">
            {% render 'article-card', 
              article: article, 
              show_image: section.settings.show_image,
              show_date: section.settings.show_date,
              show_author: section.settings.show_author,
              show_comments: section.settings.show_comments,
              show_excerpt: section.settings.show_excerpt,
              excerpt_word_count: section.settings.excerpt_word_count
            %}
          </div>
        {%- endfor -%}
      {%- endif -%}
    </div>
    
    {%- if section.settings.show_view_all and section.settings.blog != blank and blog.articles_count > posts_to_display -%}
      <div class="featured-blog__footer text-{{ section.settings.heading_alignment }}">
        <a href="{{ blog.url }}" class="button button--primary">
          {{ 'sections.featured_blog.view_all' | t }}
          <span class="icon-wrap">
            <svg class="icon icon-arrow-right" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M5 12H19M19 12L12 5M19 12L12 19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </span>
        </a>
      </div>
    {%- endif -%}
  </div>
</div>

{% schema %}
{
  "name": "Blog en vedette",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "header",
      "content": "En-tête"
    },
    {
      "type": "text",
      "id": "heading",
      "default": "Derniers articles",
      "label": "Titre"
    },
    {
      "type": "select",
      "id": "heading_size",
      "options": [
        {
          "value": "h2",
          "label": "Petit"
        },
        {
          "value": "h1",
          "label": "Moyen"
        },
        {
          "value": "h0",
          "label": "Grand"
        }
      ],
      "default": "h1",
      "label": "Taille du titre"
    },
    {
      "type": "text",
      "id": "subheading",
      "label": "Sous-titre",
      "default": "Découvrez nos derniers articles"
    },
    {
      "type": "richtext",
      "id": "description",
      "label": "Description",
      "default": "<p>Restez informé avec nos actualités et conseils</p>"
    },
    {
      "type": "select",
      "id": "heading_alignment",
      "label": "Alignement du texte",
      "options": [
        {
          "value": "left",
          "label": "Gauche"
        },
        {
          "value": "center",
          "label": "Centre"
        },
        {
          "value": "right",
          "label": "Droite"
        }
      ],
      "default": "center"
    },
    {
      "type": "header",
      "content": "Sélection du blog"
    },
    {
      "type": "blog",
      "id": "blog",
      "label": "Blog"
    },
    {
      "type": "range",
      "id": "posts_to_show",
      "min": 2,
      "max": 12,
      "step": 1,
      "default": 3,
      "label": "Nombre d'articles à afficher"
    },
    {
      "type": "range",
      "id": "columns_desktop",
      "min": 1,
      "max": 4,
      "step": 1,
      "default": 3,
      "label": "Nombre de colonnes sur ordinateur"
    },
    {
      "type": "select",
      "id": "columns_mobile",
      "options": [
        {
          "value": "1",
          "label": "1 colonne"
        },
        {
          "value": "2",
          "label": "2 colonnes"
        }
      ],
      "default": "1",
      "label": "Nombre de colonnes sur mobile"
    },
    {
      "type": "header",
      "content": "Paramètres des articles"
    },
    {
      "type": "checkbox",
      "id": "show_image",
      "default": true,
      "label": "Afficher l'image de l'article"
    },
    {
      "type": "checkbox",
      "id": "show_date",
      "default": true,
      "label": "Afficher la date"
    },
    {
      "type": "checkbox",
      "id": "show_author",
      "default": false,
      "label": "Afficher l'auteur"
    },
    {
      "type": "checkbox",
      "id": "show_comments",
      "default": false,
      "label": "Afficher le nombre de commentaires"
    },
    {
      "type": "checkbox",
      "id": "show_excerpt",
      "default": true,
      "label": "Afficher l'extrait"
    },
    {
      "type": "range",
      "id": "excerpt_word_count",
      "min": 10,
      "max": 50,
      "step": 1,
      "default": 20,
      "label": "Nombre de mots de l'extrait"
    },
    {
      "type": "checkbox",
      "id": "show_view_all",
      "default": true,
      "label": "Afficher le bouton 'Voir tout'"
    },
    {
      "type": "header",
      "content": "Style"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Schéma de couleurs",
      "default": "background-1"
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Couleur des titres",
      "default": "#1a1a1a"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Couleur du texte",
      "default": "#4d4d4d"
    },
    {
      "type": "color",
      "id": "card_background",
      "label": "Arrière-plan des cartes",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "card_border",
      "label": "Bordure des cartes",
      "default": "#e6e6e6"
    },
    {
      "type": "color_background",
      "id": "card_hover_shadow",
      "label": "Ombre au survol des cartes",
      "default": "rgba(0, 0, 0, 0.1)"
    },
    {
      "type": "header",
      "content": "Espacement"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Marge supérieure",
      "default": 36
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Marge inférieure",
      "default": 36
    }
  ],
  "presets": [
    {
      "name": "Blog en vedette",
      "settings": {
        "blog": "news",
        "posts_to_show": 3,
        "columns_desktop": 3
      }
    }
  ]
}
{% endschema %}
